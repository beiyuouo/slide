import{d as D,z as q,t as M,E as H,n as $,$ as B,b as m,i as p,e as L,x as w,o as d}from"../modules/vue-Dim-dygt.js";import{C as E,b as T}from"../index-GjFdxGIJ.js";const I=["innerHTML"],P=["textContent"],z=["textContent"],k="slidev-note-fade",r="slidev-note-click-mark",K=D({__name:"NoteDisplay",props:{class:{type:String,required:!1},noteHtml:{type:String,required:!1},note:{type:String,required:!1},placeholder:{type:String,required:!1},clicksContext:{type:null,required:!1},autoScroll:{type:Boolean,required:!1}},emits:["markerDblclick","markerClick"],setup(b,{emit:A}){const l=b,v=A,g=q(()=>{var s,n;return((s=l.clicksContext)==null?void 0:s.current)!=null&&((n=l.noteHtml)==null?void 0:n.includes("slidev-note-click-mark"))}),a=M(null);function h(){var S;if(!a.value||!g.value)return;const s=Array.from(a.value.querySelectorAll(`.${r}`)),n=+(((S=l.clicksContext)==null?void 0:S.current)??E),i=n<0||n>=E,y=new Set;function C(e){!e||e===a.value||(y.add(e),e.parentElement&&C(e.parentElement))}const _=new Map;for(const e of s){const t=e.parentElement,o=Number(e.dataset.clicks);_.set(o,e),C(t),Array.from(t.childNodes).forEach(f=>{if(f.nodeType===3){const x=document.createElement("span");x.textContent=f.textContent,t.insertBefore(x,f),f.remove()}})}const N=Array.from(a.value.querySelectorAll("*"));let c=0;const u=new Map;for(const e of N)u.has(c)||u.set(c,[]),u.get(c).push(e),e.classList.contains(r)&&(c=Number(e.dataset.clicks)||c+1);for(const[e,t]of u)i?t.forEach(o=>o.classList.remove(k)):t.forEach(o=>o.classList.toggle(k,y.has(o)?!1:e!==n));for(const[e,t]of _)t.classList.remove(k),t.classList.toggle(`${r}-past`,i?!1:e<n),t.classList.toggle(`${r}-active`,i?!1:e===n),t.classList.toggle(`${r}-next`,i?!1:e===n+1),t.classList.toggle(`${r}-future`,i?!1:e>n+1),t.ondblclick=o=>{v("markerDblclick",o,e),!o.defaultPrevented&&(l.clicksContext.current=e,o.stopPropagation(),o.stopImmediatePropagation())},t.onclick=o=>{v("markerClick",o,e)},l.autoScroll&&e===n&&t.scrollIntoView({block:"center",behavior:"smooth"})}return H(()=>{var s;return[l.noteHtml,(s=l.clicksContext)==null?void 0:s.current]},()=>{$(()=>{h()})},{immediate:!0}),B(()=>{h()}),(s,n)=>s.noteHtml?(d(),m("div",{key:0,ref_key:"noteDisplay",ref:a,class:p(["prose overflow-auto outline-none slidev-note",[l.class,g.value?"slidev-note-with-clicks":""]]),innerHTML:s.noteHtml},null,10,I)):s.note?(d(),m("div",{key:1,class:p(["prose overflow-auto outline-none slidev-note",l.class])},[L("p",{textContent:w(s.note)},null,8,P)],2)):(d(),m("div",{key:2,class:p(["prose overflow-auto outline-none opacity-50 italic select-none slidev-note",l.class])},[L("p",{textContent:w(l.placeholder||"No notes.")},null,8,z)],2))}}),F=T(K,[["__file","/home/runner/work/slide/slide/optimization-in-deep-learning/node_modules/@slidev/client/internals/NoteDisplay.vue"]]);export{F as N};
